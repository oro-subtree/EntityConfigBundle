{% extends 'OroUIBundle:actions:update.html.twig' %}
{#{% set format = oro_config_value('oro_user.name_format') %}#}
{% form_theme form with 'OroUIBundle:Form:fields.html.twig' %}


{#{% set title = form.vars.value.id ? form.vars.value.fullname(format)|default('N/A') ~ ' - ' ~ 'Update User'|trans : 'New User'|trans %}#}
{% set title = 'Update Entity' %}


{#{% oro_title_set({params : {"%username%": form.vars.value.fullname(format)|default('N/A') }}) %}#}
{% oro_title_set({params : {"%username%": 'User' }}) %}

{#{% set entityClass = 'Oro_Bundle_UserBundle_Entity_User' %}#}


{#{% set formAction = form.vars.value.id ? path('oro_user_update', { id: form.vars.value.id}) : path('oro_user_create') %}#}
{% set formAction = [] %}


{% block navButtons %}
    {#{% if form.vars.value.id and resource_granted('oro_user_user_delete') and  form.vars.value.id!=app.user.id %}#}
        {#{{ UI.deleteButton({#}
        {#'dataUrl': path('oro_api_delete_user', {'id': form.vars.value.id}),#}
        {#'dataRedirect': path('oro_user_index'),#}
        {#'aCss': 'no-hash remove-button',#}
        {#'id': 'btn-remove-user',#}
        {#'dataId':  form.vars.value.id,#}
        {#'dataMessage': 'Are you sure you want to delete this user?',#}
        {#'title': 'Delete user',#}
        {#'label': 'Delete'#}
        {#}) }}#}
        {#{{ UI.buttonSeparator() }}#}
    {#{% endif %}#}

    {{ UI.button({'path' : path('oro_entityconfig_index'), 'title' : 'Cancel', 'label' : 'Cancel'}) }}
    {{ UI.buttonType({'type': 'submit', 'class': 'btn-success', 'label': 'Save'}) }}
{% endblock navButtons %}


{% block pageHeader %}
    {#{% if form.vars.value.id %}#}
        {#{% set breadcrumbs = {#}
            {#'entity':      form.vars.value,#}
            {#'indexPath':   path('oro_entityconfig_index'),#}
            {#'indexLabel': 'Entities',#}
            {#'entityTitle': form.vars.value.fullname(format)|default('N/A'),#}
            {#'hasAvatar':   false,#}
            {#'imagePath':   '',#}
        {#}#}
        {% set breadcrumbs = {
            'entity':      'entity',
            'indexPath':   path('oro_entityconfig_index'),
            'indexLabel': 'Entities',
            'entityTitle': 'N/A',
            'hasAvatar':   false,
            'imagePath':   '',
        }
        %}
        {{ parent() }}
    {#{% else %}#}
        {#{% include 'OroUIBundle::page_title_block.html.twig' %}#}
    {#{% endif %}#}
{% endblock pageHeader %}

{% block stats %}
    {{ parent() }}
    {#<li>{{ 'Last logged in'|trans }}: {{ form.vars.value.lastLogin ? UI.time(form.vars.value.lastLogin) : 'N/A' }}</li>#}
    {#<li>{{ 'Login count'|trans }}: {{ form.vars.value.loginCount|default(0) }}</li>#}
{% endblock stats %}




{% block content_data %}
    {% set id = 'configentity-update' %}

    {% set dataBlocks = [{
        'title': 'General',
        'class': 'active',
        'subblocks': [
            {
                'title': 'General block',
                'data': [
                    form_row(form.label),
                    form_row(form.icon),
                    form_row(form.description),
                ]
            },
            {
                'title': 'General block 2',
                'data': [
                ]
            },
        ]
    }]
    %}


    {% set dataBlocks = dataBlocks|merge( [{
        'title': 'Fieldset 2',
        'subblocks': [
            {
                'title': '',
                'data': [
                ]
            }
        ]
    }] )
    %}


    {#{% if form.values is defined %}#}
        {#{% set dataBlocks = dataBlocks|merge(#}
        {#[{#}
        {#'title': 'Additional data',#}
        {#'subblocks': [{#}
        {#'title': '',#}
        {#'useSpan': false,#}
        {#'data': [#}
        {#form_row(form.values)#}
        {#]#}
        {#}]#}
        {#}]#}
        {#) %}#}
    {#{% endif %}#}

    {% set data = {
        'formErrors': form_errors(form)? form_errors(form) : null,
        'dataBlocks': dataBlocks,
        'hiddenData': form_rest(form)
    }%}


    {#{{ form_widget(form) }}#}
    {#{{ dump(form) }}#}


    {{ parent() }}
{% endblock content_data %}
